(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),a=n(8),c=n.n(a),s=(n(13),n(2)),i=(n(14),n(0)),l=function(e){var t=e.onClick;return Object(i.jsx)("div",{className:"Menu",children:Object(i.jsx)("button",{className:"Button",onClick:t,children:"Play Tetris"})})},u=(n(16),n(17),n(18),function(e){var t=e.cell;return Object(i.jsx)("div",{className:"BoardCell ".concat(t.className),children:Object(i.jsx)("div",{className:"Sparkle"})})}),p=function(e){var t=e.board,n={gridTemplateRows:"repeat(".concat(t.size.rows,", 1fr)"),gridTemplateColumns:"repeat(".concat(t.size.columns,", 1fr)")};return Object(i.jsx)("div",{className:"Board",style:n,children:t.rows.map((function(e,n){return e.map((function(e,n){return Object(i.jsx)(u,{cell:e},n*t.size.columns+n)}))}))})},m=(n(19),{Left:"Left",FastDrop:"FastDrop",Pause:"Pause",Quit:"Quit",Right:"Right",Rotate:"Rotate",SlowDrop:"SlowDrop"}),f={ArrowUp:m.Rotate,ArrowDown:m.SlowDrop,ArrowLeft:m.Left,ArrowRight:m.Right,KeyQ:m.Quit,KeyP:m.Pause,Space:m.FastDrop},d=function(e){return[m.SlowDrop,m.FastDrop].includes(e)},b=function(e){return f[e]},j=n(3),v=n(6),O={occupied:!1,className:""},h="tetromino",w={I:{shape:[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],className:"".concat(h," ").concat(h,"__i")},J:{shape:[[0,1,0],[0,1,0],[1,1,0]],className:"".concat(h," ").concat(h,"__j")},L:{shape:[[0,1,0],[0,1,0],[0,1,1]],className:"".concat(h," ").concat(h,"__l")},O:{shape:[[1,1],[1,1]],className:"".concat(h," ").concat(h,"__o")},S:{shape:[[0,1,1],[1,1,0],[0,0,0]],className:"".concat(h," ").concat(h,"__s")},T:{shape:[[1,1,1],[0,1,0],[0,0,0]],className:"".concat(h," ").concat(h,"__t")},Z:{shape:[[1,1,0],[0,1,1],[0,0,0]],className:"".concat(h," ").concat(h,"__z")}},y=function(){var e=Object.keys(w),t=e[Math.floor(Math.random()*e.length)];return w[t]},x=function(e){var t=e.className,n=e.isOccupied,r=e.position,o=e.rows;return e.shape.forEach((function(e,a){e.forEach((function(e,c){if(e){var s=n,i=a+r.row,l=c+r.column;o[i][l]={occupied:s,className:t}}}))})),o},N=function(e){var t=e.rows,n=e.columns;return{rows:Array.from({length:t},(function(){return Array.from({length:n},(function(){return Object(j.a)({},O)}))})),size:{rows:t,columns:n}}},g=function(e){var t=e.board,n=e.player,r=e.resetPlayer,o=e.addLinesCleared,a=n.tetromino,c=n.position,s=t.rows.map((function(e){return e.map((function(e){return e.occupied?e:Object(j.a)({},O)}))})),i=function(e){for(var t=e.board,n=e.position,r=e.shape,o=t.size.rows-n.row+1,a=0,c=0;c<o&&!C({delta:{row:c,column:0},position:n,shape:r,board:t}).collided;c++)a=n.row+c;return Object(j.a)(Object(j.a)({},n),{},{row:a})}({board:t,position:c,shape:a.shape}),l="".concat(a.className," ").concat(n.isFastDropping?"":"ghost");s=x({className:l,isOccupied:n.isFastDropping,position:i,rows:s,shape:a.shape}),n.isFastDropping||(s=x({className:a.className,isOccupied:n.collided,position:c,rows:s,shape:a.shape}));var u=s[0].map((function(e){return Object(j.a)({},O)})),p=0;return s=s.reduce((function(e,t){return t.every((function(e){return e.occupied}))?(p++,e.unshift(Object(v.a)(u))):e.push(t),e}),[]),p>0&&o(p),(n.collided||n.isFastDropping)&&r(),{rows:s,size:Object(j.a)({},t.size)}},P=function(e){for(var t=e.board,n=e.position,r=e.shape,o=0;o<r.length;o++)for(var a=o+n.row,c=0;c<r[o].length;c++)if(r[o][c]){var s=c+n.column;if(t.rows[a]&&t.rows[a][s]&&t.rows[a][s].occupied)return!0}return!1},S=function(e){for(var t=e.board,n=e.position,r=e.shape,o=0;o<r.length;o++)for(var a=o+n.row,c=0;c<r[o].length;c++)if(r[o][c]){var s=c+n.column;if(!(t.rows[a]&&t.rows[a][s]))return!1}return!0},C=function(e){var t=e.delta,n=e.position,r=e.shape,o=e.board,a={row:n.row+t.row,column:n.column+t.column},c=P({board:o,position:a,shape:r}),s=S({board:o,position:a,shape:r}),i=!s||s&&c?n:a;return{collided:t.row>0&&(c||!s),nextPosition:i}},D=function(e){var t=e.action,n=e.board,r=e.player,o=e.setPlayer,a=e.setGameOver;t&&(t===m.Rotate?function(e){var t=e.board,n=e.player,r=e.setPlayer,o=function(e){var t=e.piece,n=e.direction,r=t.map((function(e,n){return t.map((function(e){return e[n]}))}));return n>0?r.map((function(e){return e.reverse()})):r.reverse()}({piece:n.tetromino.shape,direction:1}),a=n.position;if(!S({board:t,position:a,shape:o})||P({board:t,position:a,shape:o}))return!1;r(Object(j.a)(Object(j.a)({},n),{},{tetromino:Object(j.a)(Object(j.a)({},n.tetromino),{},{shape:o})}))}({board:n,player:r,setPlayer:o}):function(e){var t=e.board,n=e.action,r=e.player,o=e.setPlayer,a=e.setGameOver,c={row:0,column:0},s=!1;n===m.FastDrop?s=!0:n===m.SlowDrop?c.row+=1:n===m.Left?c.column-=1:n===m.Right&&(c.column+=1);var i=C({delta:c,position:r.position,shape:r.tetromino.shape,board:t}),l=i.collided,u=i.nextPosition,p=l&&0===r.position.row;p&&a(p),o(Object(j.a)(Object(j.a)({},r),{},{collided:l,isFastDropping:s,position:u}))}({board:n,player:r,setPlayer:o,action:t,setGameOver:a}))},L=function(e){var t=e.board,n=e.gameStats,o=e.player,a=e.setGameOver,c=e.setPlayer,l=function(e){var t=e.gameStats,n=Object(r.useState)(1e3),o=Object(s.a)(n,2),a=o[0],c=o[1],i=Object(r.useState)(),l=Object(s.a)(i,2),u=l[0],p=l[1],m=Object(r.useCallback)((function(){u&&(c(u),p(null))}),[u]),f=Object(r.useCallback)((function(){a&&p(a),c(null)}),[a,p]);return Object(r.useEffect)((function(){var e=50*(t.level-1),n=Math.max(1e3-e,100);c(n)}),[t.level,c]),[a,f,m]}({gameStats:n}),u=Object(s.a)(l,3),p=u[0],f=u[1],j=u[2];!function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e}),[e]),Object(r.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){clearInterval(e)}}}),[t])}((function(){v({action:m.SlowDrop})}),p);var v=function(e){var n=e.action;D({action:n,board:t,player:o,setPlayer:c,setGameOver:a})};return Object(i.jsx)("input",{className:"GameController",type:"text",onKeyDown:function(e){var t=e.code,n=b(t);if(n===m.Pause)p?f():j();else if(n===m.Quit)a(!0);else{if(d(n)&&f(),!p)return;v({action:n})}},onKeyUp:function(e){var t=e.code,n=b(t);d(n)&&j()},autoFocus:!0})},_=(n(20),function(e){var t=e.gameStats,n=t.level,r=t.points,o=t.linesCompleted,a=t.linesPerLevel-o;return Object(i.jsxs)("ul",{className:"GameStats GameStats__right",children:[Object(i.jsx)("li",{children:"Level"}),Object(i.jsx)("li",{className:"value",children:n}),Object(i.jsx)("li",{children:"Lines to level"}),Object(i.jsx)("li",{className:"value",children:a}),Object(i.jsx)("li",{children:"Points"}),Object(i.jsx)("li",{className:"value",children:r})]})}),F=o.a.memo(_),k=(n(21),function(e){var t=e.tetromino,n=e.index,r=t.shape,o=t.className,a=N({rows:4,columns:4}),c={top:"".concat(15*n,"vw")};return a.rows=x({className:o,isOccupied:!1,position:{row:0,column:0},rows:a.rows,shape:r}),Object(i.jsx)("div",{className:"Preview",style:c,children:Object(i.jsx)("div",{className:"Preview-board",children:a.rows.map((function(e,t){return e.map((function(e,t){return Object(i.jsx)(u,{cell:e},t*a.size.columns+t)}))}))})})}),G=o.a.memo(k),R=function(e){var t=e.tetrominoes,n=t.slice(1-t.length).reverse();return Object(i.jsx)(i.Fragment,{children:n.map((function(e,t){return Object(i.jsx)(G,{tetromino:e,index:t},t)}))})},z=o.a.memo(R),A=function(e){var t;return e?(t=Object(v.a)(e.tetrominoes)).unshift(y()):t=Array(5).fill(0).map((function(e){return y()})),{collided:!1,isFastDropping:!1,position:{row:0,column:4},tetrominoes:t,tetromino:t.pop()}},E=function(e){var t=e.rows,n=e.columns,o=e.setGameOver,a=function(){var e=Object(r.useState)({level:1,linesCompleted:0,linesPerLevel:10,points:0}),t=Object(s.a)(e,2),n=t[0],o=t[1];return[n,Object(r.useCallback)((function(e){o((function(t){var n=t.points+100*e,r=t.linesPerLevel,o=t.linesCompleted+e;return{level:o>=r?t.level+1:t.level,linesCompleted:o%r,linesPerLevel:r,points:n}}),[])}),[])]}(),c=Object(s.a)(a,2),l=c[0],u=c[1],m=function(){var e=Object(r.useState)(A()),t=Object(s.a)(e,2),n=t[0],o=t[1],a=Object(r.useCallback)((function(){o((function(e){return A(e)}))}),[]);return[n,o,a]}(),f=Object(s.a)(m,3),d=f[0],b=f[1],j=function(e){var t=e.rows,n=e.columns,o=e.player,a=e.resetPlayer,c=e.addLinesCleared,i=Object(r.useState)(N({rows:t,columns:n})),l=Object(s.a)(i,2),u=l[0],p=l[1];return Object(r.useEffect)((function(){p((function(e){return g({board:e,player:o,resetPlayer:a,addLinesCleared:c})}))}),[o,a,c]),[u]}({rows:t,columns:n,player:d,resetPlayer:f[2],addLinesCleared:u}),v=Object(s.a)(j,2),O=v[0];v[1];return Object(i.jsxs)("div",{className:"Tetris",children:[Object(i.jsx)(p,{board:O}),Object(i.jsx)(F,{gameStats:l}),Object(i.jsx)(z,{tetrominoes:d.tetrominoes}),Object(i.jsx)(L,{board:O,gameStats:l,player:d,setGameOver:o,setPlayer:b})]})},M=function(e){var t=e.rows,n=e.columns,o=function(){var e=Object(r.useState)(!0),t=Object(s.a)(e,2),n=t[0],o=t[1],a=Object(r.useCallback)((function(){o(!1)}),[]);return[n,o,a]}(),a=Object(s.a)(o,3),c=a[0],u=a[1],p=a[2];return Object(i.jsx)("div",{className:"Game",children:c?Object(i.jsx)(l,{onClick:function(){return p()}}):Object(i.jsx)(E,{rows:t,columns:n,setGameOver:u})})};function Q(){return Object(i.jsx)("div",{className:"App",children:Object(i.jsx)(M,{rows:20,columns:10})})}var T=document.getElementById("root");c.a.render(Object(i.jsx)(r.StrictMode,{children:Object(i.jsx)(Q,{})}),T)}],[[22,1,2]]]);
//# sourceMappingURL=main.e94db8a5.chunk.js.map